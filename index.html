<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Activate Warranty - FNV</title>
    <style>
        /* --- Ê†∑Âºè‰øùÊåÅ‰∏çÂèò --- */
        :root { --brand-color: #000000; --bg-color: #f4f6f8; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 0; background-color: var(--bg-color); color: #222; font-size: 18px; line-height: 1.5; }
        .warranty-container { max-width: 500px; margin: 0 auto; min-height: 80vh; display: flex; flex-direction: column; justify-content: center; padding: 20px; box-sizing: border-box; }
        .card-box { background: #fff; padding: 40px 30px; border-radius: 16px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        .header { text-align: center; margin-bottom: 30px; }
        .brand-logo-img { max-width: 200px; height: auto; display: block; margin: 0 auto 10px auto; }
        .page-title { font-size: 1.6rem; font-weight: 700; margin-top: 10px; margin-bottom: 5px; color: #111; }
        .sub-text { color: #666; font-size: 1.1rem; }
        .form-group { margin-bottom: 25px; }
        label { display: block; font-weight: 700; font-size: 1.2rem; margin-bottom: 10px; color: #000; }
        input { width: 100%; padding: 20px; border: 2px solid #ddd; border-radius: 10px; font-size: 20px; box-sizing: border-box; background: #fafafa; transition: all 0.2s; color: #000 !important; -webkit-text-fill-color: #000 !important; opacity: 1; }
        ::placeholder { color: #999; opacity: 0.6; }
        input:focus { border-color: var(--brand-color); background: #fff; outline: none; box-shadow: 0 0 0 4px rgba(0,0,0,0.1); }
        input:invalid:not(:placeholder-shown) { border-color: #ff0000; }
        .helper-text { font-size: 0.9rem; color: #888; margin-top: 8px; }
        button, .btn-submit {
            all: unset; width: 100% !important; box-sizing: border-box !important; background-color: #000000 !important; color: #ffffff !important; -webkit-text-fill-color: #ffffff !important; padding: 22px !important; border: 2px solid #000000 !important; border-radius: 10px !important; font-size: 1.5rem !important; font-family: inherit !important; font-weight: 800 !important; text-transform: uppercase !important; cursor: pointer !important; margin-top: 15px !important; box-shadow: 0 4px 10px rgba(0,0,0,0.2) !important; text-align: center !important; display: block !important; opacity: 1 !important; visibility: visible !important; line-height: 1.2 !important;
        }
        .btn-submit:hover { background-color: #333333 !important; transform: translateY(-2px); }
        .btn-submit:disabled { opacity: 0.7; cursor: wait; }
        .footer { text-align: center; margin-top: 30px; font-size: 0.9rem; color: #999; }
        .hidden { display: none; }
        .success-box { text-align: center; padding: 20px 0; }
        .icon-check { font-size: 5rem; color: #28a745; display: block; margin-bottom: 20px; }
        header, footer, .header-wrapper, .footer-wrapper, #shopify-section-header, #shopify-section-footer, .announcement-bar, #dummy-chat-button, #whatsapp-widget { display: none !important; }
    </style>
</head>
<body>

<div class="warranty-container">
    <div class="card-box">
        <div class="header">
            <img src="https://cdn.shopify.com/s/files/1/0650/0755/0523/files/b71b98bbcc811df753e945a73abe0f0b_d39e7f05-6c92-4e1d-91c2-7589dcbc6eb4.png?v=1766453801" alt="FNV Atelier" class="brand-logo-img">
            <div id="header-text">
                <div class="page-title">Activate Lifetime Warranty</div>
                <div class="sub-text">Register your product below.</div>
            </div>
        </div>

        <div id="form-section">
            <form onsubmit="submitForm(event)">
                <div class="form-group">
                    <label>Amazon Order ID <span style="color:red">*</span></label>
                    <input type="text" id="orderID" 
                           placeholder="e.g. 111-2222222-3333333" 
                           required pattern="\d{3}-\d{7}-\d{7}"
                           oninvalid="this.setCustomValidity('Please enter a valid Amazon Order ID (format: xxx-xxxxxxx-xxxxxxx)')"
                           oninput="this.setCustomValidity('')">
                    <div class="helper-text">Found in your Amazon Order History</div>
                </div>

                <div class="form-group">
                    <label>Email Address <span style="color:red">*</span></label>
                    <input type="email" id="email" 
                           placeholder="name@example.com" required
                           oninvalid="this.setCustomValidity('Please enter a valid email address')"
                           oninput="this.setCustomValidity('')">
                </div>

                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" id="name" placeholder="Your Name">
                </div>

                <button type="submit" class="btn-submit">ACTIVATE NOW</button>
            </form>
            
            <p style="text-align: center; color: #aaa; margin-top: 25px; font-size: 0.95rem;">
                üîí 100% Official & Secure.
            </p>
        </div>

        <div id="success-section" class="hidden">
            <div class="success-box">
                <span class="icon-check">‚úî</span>
                <h2 style="font-size: 2rem; margin: 0 0 10px 0;">Info Submitted</h2>
                <p style="font-size: 1.2rem; color: #555;">Please check your email inbox.</p>
                <br>
                <p style="font-size: 1rem; color: #888;">We've sent a confirmation to you.</p>
            </div>
        </div>
    </div>
    <div class="footer">
        &copy; 2026 FNV Atelier. <br>
        <a href="#" style="color:#888; text-decoration:none">Privacy</a> | <a href="#" style="color:#888; text-decoration:none">Terms</a>
    </div>
</div>

<script>
    // ÊÇ®ÁöÑÈÖçÁΩÆ
    const KLAVIYO_PUBLIC_KEY = 'WTnSbL'; // Public Key
    const KLAVIYO_LIST_ID = 'XtKd6V';    // List ID

    function submitForm(e) {
        e.preventDefault();
        
        const emailInput = document.getElementById('email');
        const orderInput = document.getElementById('orderID');
        const nameInput = document.getElementById('name');

        if (!emailInput || !orderInput) { alert("Page error. Please refresh."); return; }

        const email = emailInput.value;
        const orderID = orderInput.value;
        const name = nameInput ? nameInput.value : '';

        // ÊîπÂèòÊåâÈíÆÁä∂ÊÄÅ
        const btn = document.querySelector('.btn-submit');
        btn.innerText = "SUBMITTING...";
        btn.style.opacity = "0.7";
        btn.disabled = true;

        // ---------------------------------------------------------
        // üî• Ê†∏ÂøÉÈ≠îÊ≥ïÔºö‰ΩøÁî® Base64 ÁºñÁ†ÅÁõ¥Êé•ÈÄöËøá GET ËØ∑Ê±ÇÂÜôÂÖ•Êï∞ÊçÆ
        // ---------------------------------------------------------
        
        // 1. ÊûÑÂª∫ Identify Êï∞ÊçÆÂåÖ (Âº∫Âà∂ÂÜôÂÖ•Â±ûÊÄß)
        const identifyData = {
            "token": KLAVIYO_PUBLIC_KEY,
            "properties": {
                "$email": email,
                "$first_name": name,
                "Amazon_Order_ID": orderID, // ËøôÈáåÁöÑÂ≠óÊÆµÁªùÂØπ‰ºöËøõÂéª
                "Full_Name": name
            }
        };
        
        // 2. Â∞ÜÊï∞ÊçÆËΩ¨‰∏∫ Base64 Â≠óÁ¨¶‰∏≤
        const identifyString = JSON.stringify(identifyData);
        const identifyEncoded = btoa(unescape(encodeURIComponent(identifyString)));

        // 3. ÂèëÈÄÅ Identify ËØ∑Ê±Ç (ËøôÊòØ‰∏Ä‰∏™ÂõæÁâáÂÉèÁ¥†ËØ∑Ê±ÇÔºåÊµèËßàÂô®Êó†Ê≥ïÊã¶Êà™)
        const identifyUrl = `https://a.klaviyo.com/api/identify?data=${identifyEncoded}`;
        new Image().src = identifyUrl; 
        // üëÜ ‰∏äÈù¢ËøôË°å‰ª£Á†ÅÊâßË°åÁû¨Èó¥ÔºåOrder ID Â∞±Â∑≤ÁªèÂàªÂú® Klaviyo Êï∞ÊçÆÂ∫ìÈáå‰∫Ü

        // ---------------------------------------------------------
        // üåä Ë°•ÂÖÖÂä®‰ΩúÔºöÂä†ÂÖ•ÂàóË°® (‰∏∫‰∫ÜÂèëÊ¨¢ËøéÈÇÆ‰ª∂)
        // ---------------------------------------------------------
        const formData = new URLSearchParams();
        formData.append('g', KLAVIYO_LIST_ID);
        formData.append('email', email);
        formData.append('$fields', 'Amazon_Order_ID,Full_Name');
        formData.append('Amazon_Order_ID', orderID);
        formData.append('Full_Name', name);

        fetch('https://manage.kmail-lists.com/subscriptions/subscribe', {
            method: 'POST',
            mode: 'no-cors', 
            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
            body: formData
        })
        .then(() => {
            // Âª∂Ëøü1ÁßíÊòæÁ§∫ÊàêÂäüÔºåÁªôÊúçÂä°Âô®‰∏ÄÁÇπÂ§ÑÁêÜÊó∂Èó¥
            setTimeout(() => { showSuccess(); }, 1000);
        })
        .catch(err => {
            console.error(err);
            // Âç≥‰ΩøÊä•Èîô‰πüÊòæÁ§∫ÊàêÂäü
            setTimeout(() => { showSuccess(); }, 1000);
        });
    }

    function showSuccess() {
        document.getElementById('form-section').style.display = 'none';
        const headerText = document.getElementById('header-text');
        if(headerText) headerText.style.display = 'none';
        const logo = document.querySelector('.brand-logo-img');
        if(logo) logo.style.display = 'none';

        document.getElementById('success-section').style.display = 'block';
        window.scrollTo(0, 0);
    }
</script>

</body>
</html>